\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{listings}
\newcommand{\passthrough}[1]{#1}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

% Contents of listings-setup.tex
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{enumitem}

\lstset{
    basicstyle=\footnotesize\ttfamily,
    numbers=right,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=3pt,
    backgroundcolor=\color{yellow!10},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    captionpos=b,
    breaklines=false,
    breakatwhitespace=true,
    breakautoindent=true,
    linewidth=\textwidth
}

\date{}

\begin{document}

\hypertarget{m2.2-meesjes}{%
\section{M2.2 Meesjes ****}\label{m2.2-meesjes}}

Je vindt helaas een dood meesje in de tuin. Het lijkt op een koolmeesje
maar het zou ook een pimpelmeesje kunnen zijn. Deze twee vogeltjes
lijken erg veel op elkaar. Er zijn manierenom pimpelmeesjes van
koolmeesjes te onderscheiden met behulp van uiterlijke kenmerken. Maar
je bent een Natuurkundige en geen Bioloog. Online vind je een dataset
met informatie over het massa en de spanwijdte van beide soorten
meesjes.

Voordat we aan deze opdracht beginnen moeten we eerst een nieuwe versie
downloaden van de
\href{https://das.mprog.nl/course/12\%20Opdrachten\%20Module\%201/00\%20Opdrachten/DAS_DatasetGenerator.py}{\textbf{\passthrough{\lstinline!DAS\_DatasetGenerator.py!}}}.
Zonder de nieuwe versie werkt deze opgave niet. Download ook het bestand
\href{M2.2_Meesjes.py}{\textbf{\passthrough{\lstinline!M2.2\_Meesjes.py!}}}
en zorg dat deze in dezelfde folder staat als het
\passthrough{\lstinline!DAS\_DatasetGenerator.py!} bestand.

We genereren eerst een twee datasets met behulp van de volgende regel
code:

\begin{lstlisting}
m_km, span_km, m_pm, span_pm = ds.datasetVogeltjes()
\end{lstlisting}

De variabelen hebben de volgende betekenis:

\begin{lstlisting}
m_km    : de massa van een koolmeesje in gram
span_km : de spanwijdte van een koolmeesje in cm
\end{lstlisting}

De laatste twee variabelen zijn de datapunten voor pimpelmeesjes. De
twee variabelen van de koolmeesjes horen bij elkaar. Van elk meesje in
de dataset zijn zowel de massa als de spanwijdte gemeten. De dataset is
zo geordend dat als je het n-de punt uit de
\textbf{\passthrough{\lstinline!m\_km!}}-lijst bij het n-de punt uit de
\textbf{\passthrough{\lstinline!span\_km!}}-lijst hoort. Dit zijn de
gegevens van het n-de meesje. Pas dus op dat je de lijsten in de juiste
volgorde houdt! Voor de twee variabelen van de pimpelmeesjes geldt
precies hetzelfde.

We gaan eerst naar de twee massaverdelingen van de meesjes kijken.

\begin{quote}
\begin{itemize}
\item
  \textbf{M2.2a) Plot de massaverdelingen van beide meesjes in een
  histogram. Laat in een legenda zien welke meesje bij welke kleur
  hoort. Maak ook een apart histogram waarin je spanwijdtes van de twee
  soorten meesjes plot. Maak de twee histogrammen netjes af en zorg dat
  duidelijk is welke distributie bij welk soort meesje
  hoort.}\newline\newline TIP: Gebruik de plot optie
  \textbf{\passthrough{\lstinline!alpha=0.8!}} zodat je histogrammen wat
  doorzichtig worden. Zo kan je het achterste histogram ook nog altijd
  goed zien.\newline\newline
\item
  \textbf{M2.2b) Maak een tabel waarin je voor beide soorten meesjes de
  gemiddeldes, de standaarddeviaties en de varianties noteert. Let goed
  op de notatie en denk ook even aan de eenheden.}
\end{itemize}
\end{quote}

We meten nu de massa op van het meesje dat je gevonden hebt. Gebruik de
volgende regel code om dat te doen:

\begin{lstlisting}
    mees_m_laag, mees_m_hoog = ds.meetMassaMeesje()
    
\end{lstlisting}

Je krijgt nu een onderwaarde
\textbf{\passthrough{\lstinline!mees\_m\_laag!}} en een bovenwaarde
\textbf{\passthrough{\lstinline!mees\_m\_hoog!}} terug. Deze geven de
onzekerheid op de meting aan. Het gemiddelde van deze twee is de gemeten
massa, de centrale waarde. De waarde van de massa van de mees ligt
\textbf{zeker} tussen de boven- en onderwaarde in. NB. Als je een
foutmelding krijgt dat
\textbf{\passthrough{\lstinline!meetMassaMeesje()!}} niet bestaat
controleer dan of je wel een nieuwe
\textbf{\passthrough{\lstinline!DAS\_DatasetGenerator.py!}} hebt
downgeload voor Module 2.

Met deze informatie kunnen we nu met de Frequentist Methode de kans
uitrekenen dat onze mees een Koolmeesje is.

\begin{quote}
\begin{itemize}
\item
  \textbf{M2.2c) Gebruik de dataset \passthrough{\lstinline!m\_km!} om
  de kans uit te rekenen dat je een koolmeesje vindt die een massa heeft
  die in het gebied \passthrough{\lstinline!mees\_m\_laag!} en
  \passthrough{\lstinline!mees\_m\_hoog!} in ligt. Dit noem je ook wel
  de voorwaardelijke kans
  \[P(\text{mees_m_hoog < m < mees_m_laag} \mid \text{koolmees})\]. Voor
  het gemak noteren we dit even als
  \[P(m_{\text{obs}} \mid \text{koolmees} )\]. Herhaal dit voor het
  pimpelmeesje, bereken dus ook
  \[P(m_{\text{obs}} \mid \text{pimpelmees} )\].}
\item
  \textbf{M2.2d) Als je kijkt naar de uitkomst van M2.2c), wat vogeltje
  denk je dan dat het is?}
\end{itemize}
\end{quote}

De frequentist methode, zoals we die hierboven gebruiken, is
uiteindelijk een ratio tussen twee getallen. Deze twee getallen hebben
een onzekerheid volgens de Poisson verdeling.

\begin{quote}
\begin{itemize}
\tightlist
\item
  \textbf{M2.2e) Schrijf de formule uit hoe de onzekerheden van de
  noemen en deler zich propageren naar de onzekerheid op de uitgerekende
  kans. Noteer deze formule en bereken met behulp van deze formule de
  onzekerheden uit op de kansen die je in M2.2c) hebt berekend.}
\end{itemize}
\end{quote}

Je besluit ook de spanwijdte van de mees op te meten. Misschien geeft
dat wel meer uitsluitsel.

\begin{lstlisting}
    mees_span_laag, mees_span_hoog = ds.meetLengteMeesje()
    
\end{lstlisting}

De output volgt dezelfde logica als hiervoor.

\begin{quote}
\begin{itemize}
\item
  \textbf{M2.2f) Gebruik dezelfde methode als hiervoor om beide kansen
  \[ P(w_{\text{obs}} \mid \text{koolmees} )\] en
  \[P(w_{\text{obs}} \mid \text{pimpelmees} )\] uit te rekenen maar nu
  door (alleen) gebruik te maken van de informatie van de spanwijdtes.
  Noteer ook de onzekerheden op de uitgerekende kansen.}\newline\newline
\item
  \textbf{M2.2g) Op basis van deze informatie, wat denk je nu dat het
  voor vogeltje is?}
\end{itemize}
\end{quote}

We kunnen nu natuurlijk ook de gecombineerde informatie gebruiken.
Hiervoor gaan we eerst de data visualiseren.

\begin{quote}
\begin{itemize}
\tightlist
\item
  \textbf{M2.2h) Maak een tweedimensionale scatterplot die de
  tweedimensionale dataset van de massa versus de spanwijdte voor zowel
  de pimpelmezen als de koolmezen.}\\
  \textbf{TIP} gebruik de opties
  \textbf{\passthrough{\lstinline!'o',markersize=3, alpha=0.4!}} in de
  plot functie. Zorg dat beide datasets weer hun eigen kleur hebben en
  vergeet de legenda niet.
\end{itemize}
\end{quote}

Het valt misschien op dat er een verband lijkt te zijn tussen beide
variabelen. We gaan daar eerst naar kijken naar
\href{/module-2/meerdimensionale-data}{de covariantie} en de correlatie
tussen de massa en de spanwijdte voor beide vogelsoorten.

\begin{quote}
\begin{itemize}
\item
  \textbf{M2.2i) Bereken de covariantie en de correlatie tussen de massa
  en de spanwijdte voor zowel de koolmeesje als de pimpelmeesjes
  meetgegevens.}\newline\newline
\item
  \textbf{M2.2j) Als je naar de berekende correlaties kijkt wat valt dan
  op, wat voor verband zit er tussen de twee variabelen? Als je toch
  even als een Bioloog nadenkt, is dit dan wat je
  verwacht?}\newline\newline
\end{itemize}
\end{quote}

We gaan terug naar de kansberekeningen.

\begin{quote}
\begin{itemize}
\tightlist
\item
  \textbf{M2.2k) Combineer nu de gegevens en bereken de kansen
  \[{P(m_{\text{obs}}\text{ en }w_{\text{obs}} \mid \text{koolmees})}\]
  en
  \[{P(m_{\text{obs}}\text{ en }w_{\text{obs}} \mid \text{pimpelmees})}\].}\newline\newline
\item
  \textbf{M2.2l) Welk vogeltje denk je nu dat het is? Beredeneer je
  antwoord.}
\end{itemize}
\end{quote}

Na al deze berekeningen lopen we een eindje in de tuin. Op de plek waar
we eerder het meesje aantroffen zit nu een ander meesje hartstochtelijk
te zingen. Aan de zang hoor je direct dat dit een pimpelmeesje is. Je
schat in dat er een kans is van 90\% dat dit pimpelmeesje bij het andere
meesje hoorde, en dat dat dus ook een pimpelmees is.

\begin{quote}
\begin{itemize}
\tightlist
\item
  \textbf{M2.2m) Bereken nu de kans dat het inderdaad een pimpelmeesje
  is geweest:
  \[P(\text{pimpelmees} \mid m_\text{obs} \text{ en } w_{\text{obs}}).\]
  Bereken hier alleen de centrale waarde.}\\
  TIP: Maak hierbij gebruik van de
  \href{/module-2/extra-kansrekenregels}{vergelijking} van Bayes. Om
  \[P(m_\text{obs} \text{ en }w_{\text{obs}})\] te berekenen kun je
  gebruiken maken van de volgende formule:
  \[P(C) = P(C \mid D)\cdot P(D) + P(C \mid \text{niet }D)\cdot P(\text{niet }D)\]
  .
\end{itemize}
\end{quote}

\end{document}
